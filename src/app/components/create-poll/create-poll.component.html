<div class="create-poll-container" *ngIf="texts$ | async as t">
  <div class="poll-card">
    <h2 class="poll-title">{{ t.title }}</h2>

    <div *ngIf="errorMessage" class="error-message">{{ errorMessage }}</div>

    <form [formGroup]="pollForm" (ngSubmit)="onSubmit()" class="poll-form">
      <!-- Question -->
      <div class="form-group">
        <label class="form-label" for="title">{{ t.questionLabel }}</label>
        <input id="title" class="form-input" type="text"
               formControlName="title"
               [placeholder]="t.questionPh" />
        <div class="form-error"
             *ngIf="pollForm.get('title')?.invalid && pollForm.get('title')?.touched">
          {{ t.questionError }}
        </div>
      </div>

      <!-- Description -->
      <div class="form-group">
        <label class="form-label" for="description">{{ t.descriptionLabel }}</label>
        <textarea id="description" rows="3" class="form-textarea"
                  formControlName="description"
                  [placeholder]="t.descriptionPh"></textarea>
      </div>

      <!-- Options -->
      <div class="form-group">
        <div class="options-header">
          <label class="form-label">{{ t.optionsLabel }}</label>
          <button type="button" class="add-option-button" (click)="addOption()">
            {{ t.addOption }}
          </button>
        </div>

        <div formArrayName="options" class="options-list">
          <div *ngFor="let optCtrl of options.controls; let i = index" [formGroupName]="i">
            <input class="form-input" type="text"
                   formControlName="text"
                   [placeholder]="t.optionPh + ' ' + (i + 1)" />
            <button *ngIf="i > 1" type="button"
                    class="remove-option-button" (click)="removeOption(i)">
              Remove
            </button>
          </div>
        </div>

        <div class="form-error"
             *ngIf="options.invalid && (options.dirty || options.touched)">
          {{ t.atLeastTwo }}
        </div>
      </div>

      <!-- Settings -->
      <div class="form-group">
        <label class="form-label">{{ t.settingsLabel }}</label>
        <div class="checkbox-group">
          <input id="allowMultiple" type="checkbox"
                 class="checkbox-input" formControlName="allowMultiple" />
          <label for="allowMultiple" class="checkbox-label">{{ t.allowMultiple }}</label>
        </div>
        <div class="checkbox-group">
          <input id="isPrivate" type="checkbox"
                 class="checkbox-input" formControlName="isPrivate" />
          <label for="isPrivate" class="checkbox-label">{{ t.isPrivate }}</label>
        </div>
      </div>

      <!-- Submit -->
      <button class="submit-button" type="submit"
              [disabled]="pollForm.invalid || isLoading"
              [class.loading]="isLoading">
        <span *ngIf="isLoading">{{ t.submitBusy }}</span>
        <span *ngIf="!isLoading">{{ t.submitIdle }}</span>
      </button>
    </form>
  </div>
</div>
